function handlevk(key, cb) {
  switch (key) {
    case "vkenter":
      this.document.getElementById("agttcnstbnnr").style.display = "none"; // every action hides banner
      var btna = this.document.getElementById("consBtnAgree").style;
      if (btna.border.indexOf("3px") >= 0) {
        __tcfapi("setConsent", 2, cb, true); // gave consent
      } else {
        __tcfapi("setConsent", 2, cb, false); // decline consent
      }
      break;
    case "vkleft":
    case "vkright":
      // toggle selected button
      var btna = this.document.getElementById("consBtnAgree").style;
      var btnd = this.document.getElementById("consBtnDismiss").style;
      if (btna.border.indexOf("3px") < 0) {
        btna.border = "3px solid #76b642";
        btnd.border = "1px solid #76b642";
      } else {
        btna.border = "1px solid #76b642";
        btnd.border = "3px solid #76b642";
      }
      break;
    default:
      break;
  }
}
function kbd(cb) {
  var KeyEvent = window["KeyEvent"] || {};
  KeyEvent.VK_LEFT = KeyEvent.VK_LEFT || window["VK_LEFT"] || 37;
  KeyEvent.VK_RIGHT = KeyEvent.VK_RIGHT || window["VK_RIGHT"] || 39;
  KeyEvent.VK_ENTER = KeyEvent.VK_ENTER || window["VK_ENTER"] || 13;
  var objects = document.getElementsByTagName("object");
  var mgr;
  for (var i = 0; i < objects.length; i++) {
    if (
      objects[i].type.toLowerCase() ===
      "application/oipfApplicationManager".toLowerCase()
    ) {
      mgr = objects[i];
      break;
    }
  }
  if (!mgr) {
    console.log(
      "error: oipfApplicationManager not found, cannot handle remote control input keys"
    );
    return;
  }
  var app = mgr && mgr.getOwnerApplication && mgr.getOwnerApplication(document);
  var keyset = app && app.privateData.keyset;
  keyset && keyset.setValue(keyset.NAVIGATION);
  document.onkeydown = function (event) {
    if (event.keyCode === KeyEvent.VK_ENTER) handlevk("vkenter", cb);
    if (event.keyCode === KeyEvent.VK_LEFT) handlevk("vkleft");
    if (event.keyCode === KeyEvent.VK_RIGHT) handlevk("vkright");
  };
}
